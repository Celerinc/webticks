<div class="pomodoro-container">
  <h1>ğŸ… Pomodoro Timer</h1>
  <p class="subtitle">Boost your productivity with focused work sessions</p>

  <div [class]="timerCardClass">
    <div class="session-type">{{ sessionDisplay }}</div>
    <div class="timer-display">{{ formatTime }}</div>

    <div class="progress-bar">
      <div class="progress-fill" [style.width.%]="progress"></div>
    </div>

    <div class="controls">
      <button class="btn btn-primary" (click)="handleStartPause()">
        {{ isRunning ? 'â¸ Pause' : 'â–¶ Start' }}
      </button>
      <button class="btn btn-secondary" (click)="handleReset()">ğŸ”„ Reset</button>
    </div>

    <div class="session-info">
      <div class="stat">
        <span class="stat-label">Completed</span>
        <span class="stat-value">{{ completedPomodoros }}</span>
      </div>
      <div class="stat">
        <span class="stat-label">Next Break</span>
        <span class="stat-value">{{ completedPomodoros % 4 === 3 ? 'Long' : 'Short' }}</span>
      </div>
    </div>
  </div>

  <button class="btn btn-settings" (click)="toggleSettings()">âš™ï¸ Settings</button>

  @if (showSettings) {
  <div class="settings-panel">
    <h3>Timer Settings</h3>
    <div class="setting-item">
      <label>Work Duration (minutes)</label>
      <input type="number" min="1" max="60" [value]="workDuration / 60"
        (input)="handleSettingsChange('work', $any($event.target).value)" [disabled]="isRunning" />
    </div>
    <div class="setting-item">
      <label>Short Break (minutes)</label>
      <input type="number" min="1" max="30" [value]="shortBreakDuration / 60"
        (input)="handleSettingsChange('shortBreak', $any($event.target).value)" [disabled]="isRunning" />
    </div>
    <div class="setting-item">
      <label>Long Break (minutes)</label>
      <input type="number" min="1" max="60" [value]="longBreakDuration / 60"
        (input)="handleSettingsChange('longBreak', $any($event.target).value)" [disabled]="isRunning" />
    </div>
  </div>
  }

  <div class="webticks-info">
    <p><strong>âœ¨ WebTicks Analytics Active</strong></p>
    <p class="info-text">All timer events are being tracked! Open the console to see event logs.</p>
    <details class="tracked-events">
      <summary>ğŸ“Š Tracked Events</summary>
      <ul>
        <li><code>pomodoro_started</code> - Work session begins</li>
        <li><code>pomodoro_completed</code> - Work session completes</li>
        <li><code>break_started</code> - Break begins</li>
        <li><code>break_completed</code> - Break completes</li>
        <li><code>timer_paused</code> - Timer paused</li>
        <li><code>timer_resumed</code> - Timer resumed</li>
        <li><code>timer_reset</code> - Timer reset</li>
        <li><code>settings_changed</code> - Settings modified</li>
        <li><code>session_milestone</code> - Every 4 Pomodoros</li>
      </ul>
    </details>
  </div>
</div>

<webticks-tracker backendUrl="http://localhost:3002/api/track" appId="97069816-8b25-4640-833f-f17259208a42" />